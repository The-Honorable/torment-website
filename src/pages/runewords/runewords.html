<template>
    <h3 class="text-lg type-text text-center mx-auto my-4">
        <span class="rarity-text">${filteredRunewords.length}</span> Runewords Found
    </h3>

    <search-area>
        <div class="w-full m-auto px-5 py-2">
            <div class="flex flex-wrap justify-center items-start gap-2">

                <div class="w-full lg:w-auto lg:min-w-40"
                     data-help-text="Filter by number of runes required. This amount is exact.">
                    <div class="flex items-stretch">
                        <div class="relative flex-1">
                            <select id="runecount" class="select-base peer" value.bind="selectedAmount">
                                <option repeat.for="opt of amounts" if.bind="opt.value === ''" value="">${opt.label}
                                </option>
                                <option repeat.for="opt of amounts" if.bind="opt.value !== ''" model.bind="opt.value">
                                    ${opt.label}
                                </option>
                            </select>
                            <label for="runecount" class="floating-label">Rune Count</label>
                        </div>
                        <!-- Mobile-only info button -->
                        <button type="button"
                                class="m-info-button"
                                aria-expanded="false" data-info-for="runecount"
                        >
                            <span class="mso">info</span>
                            <span class="sr-only">More info about Item Type filter</span>
                        </button>
                    </div>
                </div>

                <div class="w-full lg:w-auto lg:min-w-70 flex flex-nowrap items-stretch"
                     data-help-text="Filter by base item type. Toggle ‘Exact’ to remove variants."
                >
                    <div class="relative flex-1">
                        <select id="itype" class="select-base-exact peer" value.bind="selectedType">
                            <option repeat.for="opt of types"
                                    value.bind="opt.id">${opt.label}
                            </option>
                        </select>
                        <label for="itype" class="floating-label">Select Item Type</label>
                    </div>
                    <div class="flex items-center">
                        <button
                                type="button"
                                class="exact-button"
                                aria-pressed.bind="exclusiveType"
                                click.trigger="exclusiveType = !exclusiveType">
                            <span class="exact-indicator"></span>
                            Exact
                        </button>
                    </div>
                    <!-- Mobile-only info button -->
                    <button type="button"
                            class="m-info-button"
                            aria-expanded="false" data-info-for="itype"
                    >
                        <span class="mso">info</span>
                        <span class="sr-only">More info about Item Type filter</span>
                    </button>
                </div>

                <div class="w-full lg:w-60"
                     data-help-text="Search across all fields. Attempts exact match. Seperate with '+' for AND match. Seperate with ',' or '|' for OR match. ex. 'fire skill damage+enemy fire' finds items with only both tokens. 'fire skill damage,enemy fire' finds items with either token.">
                    <div class="flex items-stretch">
                        <div class="trailing-icon flex-1" data-icon="search">
                            <input id="inputsearch" type="text" class="select-base peer pr-12" value.bind="search"
                                   placeholder=" "/>
                            <label for="inputsearch" class="floating-label">Search...</label>
                        </div>
                        <!-- Mobile only info button -->
                        <button type="button"
                                class="m-info-button"
                                aria-expanded="false"
                                data-info-for="inputsearch">
                            <span class="mso">info</span>
                            <span class="sr-only">More info about the Hide Vanilla button</span>
                        </button>
                    </div>
                </div>

                <div class="w-full lg:w-60"
                     data-help-text="Search for specific Runes. Uses (space) and + as AND. Uses , and | as OR. ex: El Eld|Hel Zod returns only Breath of the Dying and Starlight.">
                    <div class="flex items-stretch">
                        <div class="trailing-icon flex-1" data-icon="search">
                            <input id="runesearch" type="text" class="select-base peer pr-12 w-full"
                                   value.bind="searchRunes"
                                   placeholder=" "/>
                            <label for="runesearch" class="floating-label">Runes Only...</label>
                        </div>

                        <!-- Mobile only info button -->
                        <button type="button"
                                class="m-info-button"
                                aria-expanded="false"
                                data-info-for="runesearch">
                            <span class="mso">info</span>
                            <span class="sr-only">More info about Rune Only search</span>
                        </button>
                    </div>
                </div>

                <div class="w-full lg:w-auto lg:min-w-35" data-help-text="Filter toggle to hide Vanilla items.">
                    <div class="flex items-stretch">
                        <div class="relative flex-1">
                            <button
                                    id="hidevanillabutton"
                                    type="button"
                                    class="vanilla-button flex-row-reverse"
                                    aria-pressed.bind="hideVanilla"
                                    click.trigger="hideVanilla = !hideVanilla">
                                <span class="vanilla-indicator"></span>
                                Hide Vanilla
                            </button>
                        </div>
                        <!-- Mobile only info button -->
                        <button type="button"
                                class="m-info-button"
                                aria-expanded="false"
                                data-info-for="hidevanillabutton">
                            <span class="mso">info</span>
                            <span class="sr-only">More info about the Hide Vanilla button</span>
                        </button>
                    </div>
                </div>

                <div class="w-full lg:w-auto lg:min-w-35" data-help-text="Reset all filters to default.">
                    <div class="flex items-stretch">
                        <div class="relative flex-1">
                            <button id="resetfilters" class="button-base" type="button" click.trigger="resetFilters()">
                                Reset Filters
                            </button>
                        </div>
                        <!-- Mobile only info button -->
                        <button type="button"
                                class="m-info-button"
                                aria-expanded="false"
                                data-info-for="resetfilters">
                            <span class="mso">info</span>
                            <span class="sr-only">More info about the Hide Vanilla button</span>
                        </button>
                    </div>
                </div>

            </div>
        </div>
    </search-area>

    <div class="card-container">
        <div class="card-box card-vis" repeat.for="runeword of filteredRunewords">

            <div class="mb-1">
                <div class="text-xl unique-text">
                    ${runeword.Name}
                </div>
                <div class="text-base rarity-text">
                    ${runeword.Vanilla === 'Y' ? 'Vanilla' : 'Mod'}
                </div>
            </div>

            <div class="text-base type-text mb-1"><span repeat.for="type of runeword.Types">
                        ${type.Name} ${$index + 1 !== runeword.Types.length ? ' or ' : ''}
                    </span></div>

            <div class="text-base type-text"><span repeat.for="rune of runeword.Runes">
                        ${rune.Name | runeName} ${$index + 1 !== runeword.Runes.length ? ' + ' : ''}
                    </span></div>

            <div class="text-base requirement-text my-1">
                Required Level: ${runeword.RequiredLevel > 0? runeword.RequiredLevel: 1}
            </div>

            <div class="text-base prop-text" repeat.for="property of runeword.Properties">
                ${property.PropertyString}
            </div>

        </div>
    </div>
</template>
